# 칸반보드 프로젝트 개발 일지 - 2025년 9월 4일

## 📋 오늘의 주요 작업

### 1. 데이터 지속성 시스템 구현 ✅
- **문제**: 서버 재시작 시 모든 데이터가 사라지는 문제
- **해결**: JSON 파일 기반 데이터 저장소 구현
- **구현 내용**:
  - `data/kanban-data.json`: 칸반보드 데이터 분리 저장
  - API 엔드포인트 구현 (CRUD 작업)
  - 프론트엔드 API 연동

### 2. 옵티미스틱 업데이트 적용 ✅
- **문제**: 카드 이동 시 깜빡임 현상 발생
- **해결**: 즉시 UI 업데이트 + 백그라운드 API 호출 방식
- **개선 효과**:
  - 카드 드래그앤드롭이 부드럽게 동작
  - 실시간 반응성 향상
  - API 실패 시 자동 롤백 기능

### 3. 회원가입 기능 구현 ✅
- **구현 기능**:
  - 로그인/회원가입 시스템
  - admin/admin 기본 계정 생성
  - 세션 관리 (localStorage 기반)
  - 보호된 라우트 (로그인 필요)
- **파일 구조**:
  - `contexts/AuthContext.tsx`: 인증 컨텍스트
  - `components/AuthModal.tsx`: 로그인/회원가입 모달
  - `pages/api/auth/`: 인증 API 엔드포인트
  - `data/users.json`: 사용자 데이터 저장

### 4. 간트 차트 오류 수정 ✅
- **문제**: 간트 탭 클릭 시 JavaScript 오류 발생
- **해결**: 안전한 날짜 처리 및 에러 핸들링 추가
- **개선 내용**:
  - 날짜 검증 함수 `safeDate()` 구현
  - try-catch 블록으로 예외 처리
  - 기본값 및 범위 제한 설정

## 🛠 기술적 구현 세부사항

### API 엔드포인트
- `GET /api/kanban`: 전체 보드 데이터 조회
- `PUT /api/kanban`: 보드 데이터 업데이트
- `POST /api/cards`: 새 카드 생성
- `PUT /api/cards/[id]`: 카드 정보 업데이트
- `DELETE /api/cards/[id]`: 카드 삭제
- `PUT /api/cards/move`: 카드 이동
- `POST /api/auth/login`: 로그인
- `POST /api/auth/signup`: 회원가입

### 데이터 구조 개선
```json
{
  "board": {
    "id": "1",
    "title": "프로젝트 관리 보드",
    "ownerId": "admin",
    "createdAt": "2024-01-01T00:00:00.000Z",
    "columns": [...],
    "users": [...],
    "labels": [...],
    "milestones": [...]
  }
}
```

### 사용자 관리 시스템
```json
{
  "users": [
    {
      "id": "admin",
      "name": "관리자",
      "email": "admin@admin.com",
      "password": "admin",
      "role": "admin",
      "createdAt": "2024-01-01T00:00:00.000Z"
    }
  ]
}
```

## 🎯 성능 최적화

### 옵티미스틱 업데이트 패턴
1. **즉시 UI 업데이트**: 사용자 액션 발생 즉시 로컬 상태 변경
2. **백그라운드 동기화**: API 호출을 백그라운드에서 실행
3. **실패 시 롤백**: API 실패 시 이전 상태로 복구
4. **에러 핸들링**: 사용자에게 명확한 피드백 제공

### 카드 이동 플로우
```
사용자 드래그 → 즉시 UI 변경 → API 호출 → 성공: 유지 / 실패: 롤백
```

## 🔐 보안 강화

### 인증 시스템
- **클라이언트 측 세션 관리**: localStorage 기반
- **비밀번호 보안**: 클라이언트로 비밀번호 전송하지 않음
- **입력 검증**: 이메일 형식, 비밀번호 길이 검증
- **권한 관리**: admin/user 역할 구분

### 라우트 보호
- 로그인하지 않은 사용자는 칸반보드 접근 불가
- 인증 상태에 따른 UI 변경
- 자동 로그아웃 시 로그인 화면으로 리다이렉션

## 🐛 해결된 문제들

### 1. 서버 재시작 시 데이터 손실
- **원인**: 메모리 내 데이터 저장
- **해결**: JSON 파일 기반 영구 저장

### 2. 카드 이동 시 깜빡임
- **원인**: API 호출 후 전체 데이터 리로드
- **해결**: 옵티미스틱 업데이트 패턴 적용

### 3. Next.js 빌드 오류
- **원인**: TypeScript 타입 불일치
- **해결**: 
  - `ViewMode` 타입에 'manual' 추가
  - 비동기 함수 타입 수정
  - react-markdown 타입 오류 해결

### 4. 간트 차트 오류
- **원인**: 안전하지 않은 날짜 처리
- **해결**: 
  - `safeDate()` 함수로 날짜 검증
  - try-catch 블록 추가
  - 기본값 설정

## 📁 파일 구조 변경

### 새로 생성된 파일
```
├── data/
│   ├── kanban-data.json      # 칸반보드 데이터
│   └── users.json           # 사용자 데이터
├── contexts/
│   └── AuthContext.tsx      # 인증 컨텍스트
├── components/
│   └── AuthModal.tsx        # 로그인/회원가입 모달
├── hooks/
│   └── useKanbanAPI.ts      # API 기반 칸반 훅
└── pages/api/
    ├── auth/
    │   ├── login.ts         # 로그인 API
    │   └── signup.ts        # 회원가입 API
    ├── cards/
    │   ├── index.ts         # 카드 생성 API
    │   ├── [id].ts          # 카드 수정/삭제 API
    │   └── move.ts          # 카드 이동 API
    └── kanban.ts            # 보드 데이터 API
```

### 수정된 파일
- `pages/index.tsx`: 인증 기능 통합
- `components/Layout.tsx`: 사용자 정보 표시, 인증 확인
- `components/GanttView.tsx`: 안전한 날짜 처리
- `types/index.ts`: 인증 관련 타입 추가
- `pages/_app.tsx`: AuthProvider 추가

## 🚀 다음 단계 개선 사항

### 예정된 기능
1. **다중 보드 지원**: 사용자별 여러 보드 생성 가능
2. **실시간 협업**: WebSocket 기반 실시간 업데이트
3. **파일 첨부**: 카드에 파일 첨부 기능
4. **알림 시스템**: 마감일 알림, 카드 변경 알림
5. **데이터 내보내기**: CSV, JSON 형태로 데이터 내보내기

### 기술적 개선
1. **데이터베이스 연동**: SQLite 또는 PostgreSQL 연동
2. **JWT 토큰**: 보다 안전한 인증 방식
3. **압축**: API 응답 압축으로 성능 향상
4. **캐싱**: Redis 기반 캐싱 시스템

## 📊 프로젝트 현황

### 완료된 기능 ✅
- [x] 기본 칸반보드 기능
- [x] 드래그앤드롭
- [x] 카드 CRUD
- [x] 필터링 및 검색
- [x] 캘린더 뷰
- [x] 간트 차트 뷰
- [x] 데이터 지속성
- [x] 사용자 인증
- [x] 회원가입 기능

### 진행 중인 작업 🔄
- [ ] 성능 최적화
- [ ] UI/UX 개선
- [ ] 추가 기능 기획

### 기술 스택
- **Frontend**: Next.js 14, React 18, TypeScript
- **Styling**: Tailwind CSS
- **State Management**: React Context + Custom Hooks
- **DnD**: @hello-pangea/dnd
- **Date Handling**: date-fns
- **Data Storage**: JSON Files
- **Authentication**: Custom JWT-like system

## 💡 학습한 내용

1. **옵티미스틱 업데이트 패턴**의 중요성과 구현 방법
2. **Next.js API Routes**를 활용한 백엔드 구현
3. **React Context**를 이용한 글로벌 상태 관리
4. **에러 핸들링**의 중요성과 사용자 경험 개선
5. **타입 안전성**을 위한 TypeScript 활용

---

**작업 시간**: 약 4시간  
**주요 성과**: 완전한 기능의 칸반보드 프로젝트 완성  
**다음 작업**: 추가 기능 기획 및 성능 최적화